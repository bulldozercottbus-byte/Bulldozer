<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Club Intern</title>

<!-- Firebase COMPAT -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<style>
body {
  margin: 0;
  background: #0f0f0f;
  color: #eee;
  font-family: Arial, sans-serif;
}
.hidden { display: none; }

nav {
  background: #000;
  padding: 12px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

nav span { font-weight: bold; }

button {
  background: #333;
  color: #fff;
  border: none;
  padding: 8px;
  cursor: pointer;
}
button:hover { background: #555; }

input, textarea {
  width: 100%;
  background: #111;
  color: #fff;
  border: 1px solid #333;
  padding: 6px;
  margin-bottom: 10px;
}

.box {
  background: #1c1c1c;
  padding: 15px;
  margin: 15px;
  border-radius: 8px;
}

.admin { border: 2px solid #a00; }
.role { border-left: 4px solid #444; }
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginView" style="text-align:center;margin-top:120px;">
  <h1>Club Interner Bereich</h1>
  <input id="loginEmail" placeholder="E-Mail">
  <input id="loginPassword" type="password" placeholder="Passwort">
  <button onclick="login()">Login</button>
  <p id="loginError" style="color:#f55;"></p>
</div>

<!-- DASHBOARD -->
<div id="dashboardView" class="hidden">

  <nav>
    <span id="navUser"></span>
    <button onclick="logout()">Logout</button>
  </nav>

  <!-- PROFIL -->
  <div id="profileBox" class="box"></div>

  <!-- HANGAROUND -->
  <div id="hangaroundBox" class="box role hidden">
    <h3>ğŸŸ¤ Hangaround</h3>
    <p>Eigene Notizen & Ãœbersicht.</p>
    <textarea placeholder="Eigene Notizen..."></textarea>
  </div>

  <!-- PROSPECT -->
  <div id="prospectBox" class="box role hidden">
    <h3>ğŸŸ¡ Prospect</h3>
    <p>Ausfahrten dokumentieren:</p>
    <input type="date">
    <textarea placeholder="Welche Ausfahrt?"></textarea>
  </div>

  <!-- MEMBER -->
  <div id="memberBox" class="box role hidden">
    <h3>ğŸŸ¢ Member</h3>
    <p>Abstimmungen & Meeting-Notizen</p>
    <textarea placeholder="Meeting / Abstimmung"></textarea>
  </div>

  <!-- ROAD CAPTAIN -->
  <div id="roadCaptainBox" class="box role hidden">
    <h3>ğŸ”µ Road Captain</h3>
    <p>Ausfahrten planen</p>
    <textarea placeholder="Route / Planung"></textarea>
  </div>

  <!-- SERGEANT AT ARMS -->
  <div id="saaBox" class="box role hidden">
    <h3>ğŸ›¡ï¸ Sergeant-at-Arms</h3>
    <p>Disziplin / Meldungen</p>
    <textarea placeholder="Meldung / Vorfall"></textarea>
  </div>

  <!-- SECRETARY -->
  <div id="secretaryBox" class="box role hidden">
    <h3>ğŸ“ Secretary</h3>
    <p>Protokolle & BestÃ¤tigungen</p>
    <textarea placeholder="Protokoll"></textarea>
  </div>

  <!-- TREASURER -->
  <div id="treasurerBox" class="box role hidden">
    <h3>ğŸ’° Treasurer</h3>
    <p>Clubkasse & BeitrÃ¤ge</p>
    <textarea placeholder="Ein-/Ausgaben"></textarea>
  </div>

  <!-- VICE PRESIDENT -->
  <div id="vpBox" class="box role hidden">
    <h3>ğŸ‘‘ Vice President</h3>
    <p>Leitungs- & Clubinfos</p>
    <textarea placeholder="AnkÃ¼ndigung"></textarea>
  </div>

  <!-- PRESIDENT -->
  <div id="presidentBox" class="box role hidden">
    <h3>ğŸ‘‘ President</h3>
    <p>Finale Entscheidungen</p>
    <textarea placeholder="Entscheidung"></textarea>
  </div>

  <!-- ADMIN -->
  <div id="adminBox" class="box admin hidden">
    <h3>ğŸ”§ ADMIN â€“ VOLLER ZUGRIFF</h3>
    <p>Admin kann alles sehen & bearbeiten.</p>
  </div>

</div>

<script>
// ================= FIREBASE =================
const firebaseConfig = {
  apiKey: "AIzaSyCnFEjFOcrpwjHtVnQ_-QssGtEhY__FzDk",
  authDomain: "bulldozer-f8a26.firebaseapp.com",
  projectId: "bulldozer-f8a26",
  storageBucket: "bulldozer-f8a26.firebasestorage.app",
  messagingSenderId: "576318762826",
  appId: "1:576318762826:web:7d812e32e152d64d425bb3"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// ================= LOGIN =================
function login() {
  auth.signInWithEmailAndPassword(
    loginEmail.value,
    loginPassword.value
  ).catch(e => loginError.innerText = e.message);
}

function logout() {
  auth.signOut();
}

// ================= AUTH STATE =================
auth.onAuthStateChanged(user => {
  if (!user) {
    loginView.classList.remove("hidden");
    dashboardView.classList.add("hidden");
    return;
  }

  loginView.classList.add("hidden");
  dashboardView.classList.remove("hidden");

  db.collection("users").doc(user.uid).get().then(doc => {
    const d = doc.data();

    navUser.innerText = d.name + " (" + d.rank + ")";
    profileBox.innerHTML = `
      <strong>Name:</strong> ${d.name}<br>
      <strong>Rang:</strong> ${d.rank}<br>
      <strong>Mitglied seit:</strong> ${d.memberSince}
    `;

    // Admin
    if (d.isAdmin === true) {
      document.querySelectorAll(".role").forEach(e => e.classList.remove("hidden"));
      adminBox.classList.remove("hidden");
      return;
    }

    // Rollen anzeigen
    if (d.rank === "hangaround") hangaroundBox.classList.remove("hidden");
    if (d.rank === "prospect") prospectBox.classList.remove("hidden");
    if (d.rank === "member") memberBox.classList.remove("hidden");
    if (d.rank === "road_captain") roadCaptainBox.classList.remove("hidden");
    if (d.rank === "sergeant_at_arms") saaBox.classList.remove("hidden");
    if (d.rank === "secretary") secretaryBox.classList.remove("hidden");
    if (d.rank === "treasurer") treasurerBox.classList.remove("hidden");
    if (d.rank === "vice_president") vpBox.classList.remove("hidden");
    if (d.rank === "president") presidentBox.classList.remove("hidden");
  });
});
</script>

</body>
</html>
